import { useRef } from 'react';
import { useNavigate } from 'react-router-dom';
import { Tooltip, Box, Typography, IconButton } from '@mui/material';
import { ChevronLeft, ChevronRight } from '@mui/icons-material';
import styles from '../EventPage.module.scss';
import homeIcon from '../../../pics/homelogo.png';
import { Link } from 'react-router-dom';
import { timelineEvents } from './TimeLineEvents/timelineEvents'; 

const GrunvaldPage = () => {
  const timelineRef = useRef<HTMLDivElement>(null);
  const navigate = useNavigate();
  const scrollTimeline = (direction: 'left' | 'right') => {
    if (timelineRef.current) {
      timelineRef.current.scrollBy({
        left: direction === 'left' ? -200 : 200,
        behavior: 'smooth'
      });
    }
  };

  return (
    <div className={styles.container}>
      {/* Шапка */}
      <header className={styles.header}>
        <Link to="/home">
          <IconButton className={styles.homeButton} aria-label="На главную">
            <img src={homeIcon} alt="На главную" className={styles.homeIcon} />
          </IconButton>
        </Link>
        <Typography variant="h1" className={styles.headerTitle}>
          События в истории Беларуси
        </Typography>
      </header>

      {/* Основное содержимое */}
      <main className={styles.mainContent}>
        {/* Горизонтальная лента времени */}
        <div className={styles.timelineContainer}>
          <IconButton
            className={styles.timelineArrow}
            onClick={() => scrollTimeline('left')}
          >
            <ChevronLeft />
          </IconButton>

          <div className={styles.timelineWrapper} ref={timelineRef}>
            <div className={styles.timeline}>
              {timelineEvents.map((event, index) => (
                <Tooltip
                  key={index}
                  title={
                    <Box sx={{ p: 1 }}>
                      {event.events.map((item, itemIndex) => (
                        <Box
                          key={itemIndex}
                          sx={{
                            mb: 1,
                            cursor: item.link ? "pointer" : "default",
                            "&:hover": {
                              backgroundColor: item.link ? "rgba(0, 0, 0, 0.05)" : "transparent"
                            },
                          }}
                          onClick={(e) => {
                            e.stopPropagation(); // Чтобы не срабатывал клик по маркеру
                            if (item.link) navigate(item.link);
                          }}
                        >
                          <Typography variant="body2" sx={{ fontFamily: "Huninn", fontWeight: "bold", color: "#5c3a21" }}>
                            {item.title}
                          </Typography>
                        </Box>
                      ))}
                    </Box>
                  }
                  placement="bottom"
                  arrow
                >
                  <div className={styles.timelineMarker}>
                    {event.year}
                  </div>
                </Tooltip>
              ))}
            </div>
          </div>

          <IconButton
            className={styles.timelineArrow}
            onClick={() => scrollTimeline('right')}
          >
            <ChevronRight />
          </IconButton>
        </div>

        <div className={styles.textBlock}>
          <div className={styles.scrollableContent}>
            <Typography variant="h2" className={styles.figureName}>
              Грюнвальдская битва
            </Typography>
            <Typography variant="subtitle1" className={styles.figureDates}>
              (15 июля 1410 г.)
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Сложно переоценить значение Грюнвальдской битвы в истории Беларуси, Польши, да и всей Европы в
              целом. В результате одной из самых масштабных битв средневекового мира, полностью изменилась
              расстановка сил на мировой арене - Беларусь (в те времена - Великое Княжество Литовское) и
              Королевство Польское вышли на доминирующие позиции в Европе.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              15 июля 1410 года объединенные силы Королевства польского и Великого княжества Литовского
              (современная Беларусь) наголову разбили главные силы Тевтонского ордена, тем самым положив
              конец более чем двухсотлетним военным конфликтам и остановив немецкую агрессию на много столетий вперед.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Началось все с того, что в мае 1409 года на территории Жемайтии (часть территории современной Литвы),
              подконтрольной Тевтонскому Ордену, начались массовые восстания. Великое Княжество Литовское поддержало
              эти восстания, а Орден пригрозил вторжением на земли ВКЛ. В поддержку своего союзника выступило
              Королевство Польское, а на угрозы Ордена, пригрозило своим вторжением на его земли.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Вскоре после этих событий, 6 августа 1409 года, Великий Магистр Тевтонского Ордена Ульрих фон Юнгинген
              объявил войну Польскому Королевству и Великому Княжеству Литовскому.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Вскоре после объявления войны, крестоносцы атаковали ряд польских замков и небольших приграничных городков.
              Сражения велись в основном на приграничных территориях, но было ясно - ни одна из сторон не готова к
              полномасштабной войне. Осенью этого же года было подписано мирное соглашение, которое должно было
              действовать до 21 июня 1410 года. Обе стороны использовали это время для подготовки к решающей битве.
              К декабрю 1409 года двоюродные братья – Ягайло, Король Польши и Витовт, Великий Князь Литовский,
              согласовали общую стратегию: армии двух стран должны были объединиться в одну общую силу и двигаться
              по направлению к столице Тевтонского Ордена – Мариенбургу.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              В конце мая 1410 года в Гродно начали собираться хоругви Великого Княжества Литовского — из Беларуси,
              современной Литвы, северной Украины и Жмуди. К ним присоединились татарские всадники и другие союзники.
              Армии союзников объединились на территории Королевства Польского и выступили в сторону столицы Ордена.
              Данные о численности войск несколько рознятся. Общепризнанными считаются цифры: 39 000 воинов в армии
              союзников и 27 000 воинов в армии Ордена. Количественный состав армий союзников был примерно равным.
              Армия Литвы состояла из 40 хоругвей, большинство из которых прибыли из городов, находящихся ныне на
              территории современной Беларуси. Под знамена Тевтонского Ордена собрались рыцари из большинства европейских
              стран: Англии, Франции, Венгрии, Швейцарии, Голландии и др. Всего в войско тевтонов вошло 22 нации.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              На рассвете 15 июля 1410 года оба войска встретились на холмистом поле, раскинувшемся между деревнями 
              Грюнвальд, Танненберг и Людвигздорф. Прибывшие первыми крестоносцы заняли позицию на холме и имели в
              своем распоряжении запас времени на подготовку к битве. На поле были вырыты и замаскированы «волчьи ямы»,
              установлены препятствия, расставлены пушки. Подошедшие позже войска ВКЛ и Королевства Польского расположились
              южнее деревни Таненберг. Левую часть поля заняли Польские войска, а армия Великого Княжества – правую,
              наемники и союзники расположились по центру. Ульрих фон Юнгинген рассчитывал задержать вражескую кавалерию
              около препятствий и уничтожить её выстрелами из пушек, залпами арбалетчиков и лучников. А затем, остановив
              атаку противника, бросить в бой свою тяжелую конницу.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Несколько часов союзное войско ждало символической команды, а Ягайло не спешил начинать атаку. Польский
              король все это время молился в походной часовне, где отстоял две мессы подряд. Закончив молиться, Ягайло
              начал рукополагать в рыцари несколько сотен молодых воинов. Видя нерешительность союзников и придерживаясь
              своего плана, Великий Магистр Тевтонского Ордена отправил к Ягайло двух герольдов. Они принесли два
              обнажённых меча: от верховного магистра Юнгингена – королю Владиславу и от грандмаршала Валленрода –
              великому князю Витовту, а на словах передали им вызов на битву.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Великая битва началась в полдень. Витовт, так и не дождавшись приказа Польского Короля, начал атаку на
              Орден, послав в наступление на хоругви грандмаршала Фридриха фон Валенрода татарскую конницу. За татарами
              последовала первая линия тяжелых конных воинов ВКЛ. После часа боев Валленрод приказал своим рыцарям
              контратаковать. Чтобы избежать разгромной атаки тяжеловооруженных тевтонских рыцарей, татары и всадники
              ВКЛ оторвались от противника и начали отступать на северо-запад от Танненберга.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Тевтонцы посчитали, что армия Литвы практически уничтожена, и бросились в неорганизованную погоню
              за отступающими всадниками, растеряв при этом свой боевой порядок. Тяжелая кавалерия Ордена в погоне
              за отступающими татарскими и литовскими всадниками достигла основной армии союзников и обрушилась на
              правый фланг. По приказу Витовта князь Лугвений Ольгердович с его хоругвями, находившимися неподалеку
              от правого фланга польской армии, должен был любыми средствами удержать свои позиции и прикрыть
              поляков от удара во фланг и спину. Неся огромные потери, эти хоругви выстояли, а вскоре на поле
              боя вернулись, перегруппировавшись, отступавшие ранее литовские отряды, при этом часть войск
              крестоносцев попала в окружение и была уничтожена.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Еще в момент отступления войск ВКЛ началась крупная битва между основными польскими и орденскими силами.
              Крестоносцы под командованием великого комтура Куно фон Лихтенштейна начали атаку на правый фланг
              польских войск. Разгорелась яростная битва. В один из моментов сражения упала большая хоругвь Краковской
              земли, однако вскоре она снова зареяла над армией союзников. Тевтонцы восприняли ее падение как божий
              знак и начали петь пасхальный гимн "Christ ist erstanden von der Marte alle...", считая, что победа
              уже на их стороне. В этот момент король Ягайло двинул на помощь основным войскам свои резервные хоругви,
              а на поле боя вернулась тяжелая конница Витовта.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Двинул в бой свой резерв и магистр Ордена Ульрих фон Юнгинген, произошло это на пятом часу битвы. Одним
              из переломных моментов битвы стало возвращение конницы Витовта на поле боя. Был нанесен сильный удар по
              левому флангу ордена, который к тому моменту увяз в бою с пехотой и потерял маневренность. Введенные
              резервы Польской армии позволили практически взять крестоносцев в кольцо. Сражение докатилось до
              верховных командиров Тевтонского Ордена. Оруженосцы много раз предлагали Магистру Ульриху фон
              Юнгингену спастись бегством, отступить, к тому моменту уже стало понятно, что для Ордена эта битва
              проиграна. Однако Магистр отказался, заявив: «Не дай мне Бог оставить это поле, на котором погибло
              столько доблестных мужей!». После гибели Юнгингена остатки армии Ордена обратились в бегство.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Войска союзников - Королевства Польского и Великого Княжества Литовского, одержали решающую победу.
              В тот день большинство рыцарей Ордена было убито или взято в плен. Погибли и все три командующих.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              После проигранной битвы Орден так и не смог оправиться от поражения и вскоре прекратил свое
              существование. Высокой была цена победы и для наших предков. Около половины воинов армии Великого
              Княжества Литовского навсегда остались на поле боя у местечка Грюнвальд.
            </Typography>

            <Typography variant="body1" className={styles.paragraph}>
              Грюнвальдская битва была одной из крупнейших битв средневековой Европы и является одной из важнейших
              побед в истории Беларуси и Польши. Огромное влияние оказала битва и на формирование нашей нации.
              Историки говорят, что на битву шли Полотчане, Витебляне, Городенцы, а с битвы – Литвины.
            </Typography>
          </div>
        </div>
      </main>
    </div>
  );
};

export { GrunvaldPage };